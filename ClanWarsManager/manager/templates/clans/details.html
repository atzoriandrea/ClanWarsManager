{% extends 'base.html' %}

{% block title %}{{clan.name}}{% endblock %}

{% block content %}
    <h2>Clan: {{clan.name}}</h2>
    {% if user.is_authenticated and user.clan is None and clan.members.count < clan.maxMembers %}
        <form method="POST" action="{% url 'clans_join' clan.id%}">
                {% csrf_token %}
                <p>
                    <input type="submit" value="Enter"/>
                </p>
        </form>
    {% endif %}
    <h4>Members:</h4>
    <ul>
        {% for member in clan.members.all %}
            <li>
                {% if clan.clanMaster == member%}
                    CM -
                {% endif %}
                {{member.username}}
            </li>
        {% endfor %}
    </ul>
    {% if user.is_authenticated and user.clan is not None and user.clan.clanMaster == user  %}
        <form method="POST" action="{% url 'clans_fight' clan.id%}">
                {% csrf_token %}
                <p>
                    <input type="submit" value="Fight"/>
                </p>
        </form>
    {%endif%}
    {% if clan == user.clan %}
        <form method="POST" action="{% url 'clans_leave' %}">
            {% csrf_token %}
            <p>
                <input type="submit" value="Leave"/>
            </p>
        </form>
    {% endif %}
    
    {% load toasts %}
    {% toast_if request.GET.joined "Sei entrato a far parte del clan" %}
    {% toast_if request.GET.leaved "Hai abbandonato il clan" %}
    
{% endblock %}
