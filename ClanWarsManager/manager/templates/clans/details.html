{% extends 'base.html' %}

{% block title %}{{object.name}}{% endblock %}

{% block content %}
    <h2>Clan: {{object.name}}</h2>
    {% if user.is_authenticated and user.clan is None and object.members.count < object.maxMembers %}
        <form method="POST" action="{% url 'clans_join' object.id%}">
                {% csrf_token %}
                <p>
                    <input type="submit" value="Enter"/>
                </p>
        </form>
    {%endif%}
    {% if request.GET.kickedUsername is not None %}
        <p>Hai rimosso ----> {{ request.GET.kickedUsername }}</p>
    {%endif%}
    {% if request.GET.joined %}
        <p>Sei entrato a far parte del clan</p>
    {%endif%}
    {% if request.GET.leaved %}
        <p>Hai abbandonato il clan</p>
    {%endif%}
    <h4>Members:</h4>
    <ul>
        {% for member in object.members.all %}
            <li>
                {% if object.clanMaster == member%}
                    CM -
                {% endif %}
                {{member.username}}
            </li>
        {% endfor %}
    </ul>
    {% if user.is_authenticated and user.clan is not None and user.clan.clanMaster == user  %}
        <form method="POST" action="{% url 'clans_fight' object.id%}">
                {% csrf_token %}
                <p>
                    <input type="submit" value="Fight"/>
                </p>
        </form>
    {%endif%}
    {% if object == user.clan %}
        <form method="POST" action="{% url 'clans_leave' %}">
            {% csrf_token %}
            <p>
                <input type="submit" value="Leave"/>
            </p>
        </form>
    {% endif %}

{% endblock %}